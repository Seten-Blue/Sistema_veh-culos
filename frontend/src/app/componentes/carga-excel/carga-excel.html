<div class="container mt-5 p-4 card shadow-lg bg-dark text-light">
  <h3 class="text-center mb-4">ðŸ“Š Carga Masiva de VehÃ­culos (Excel)</h3>

  <!-- Subir archivo -->
  <div class="mb-3 text-center">
    <input type="file" class="form-control" (change)="onFileSelected($event)" />
    <small *ngIf="nombreArchivo" class="text-info d-block mt-2">
      Archivo seleccionado: {{ nombreArchivo }}
    </small>
  </div>

  <!-- Mensaje y progreso -->
  <div *ngIf="mensaje" class="alert alert-info text-center">
    {{ mensaje }}
  </div>
  <div *ngIf="cargando" class="progress mb-3">
    <div class="progress-bar progress-bar-striped progress-bar-animated" [style.width.%]="progreso">
      {{ progreso }}%
    </div>
  </div>

  <!-- Validaciones -->
  <div *ngIf="validacionColumnas.length > 0" class="mb-4">
    <h5>ValidaciÃ³n de columnas:</h5>
    <ul class="list-group">
      <li *ngFor="let v of validacionColumnas"
          [class.list-group-item-success]="v.valida"
          [class.list-group-item-danger]="!v.valida"
          class="list-group-item">
        {{ v.columna }} - {{ v.mensaje }}
      </li>
    </ul>
  </div>

  <!-- Vista previa -->
  <div *ngIf="mostrarPreview && previewData" class="table-responsive mt-3">
    <h5>Vista previa (primeras filas)</h5>
    <table class="table table-dark table-hover table-sm">
      <thead>
        <tr>
          <th *ngFor="let col of previewData.columnas">{{ col }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let fila of previewData.filas">
          <td *ngFor="let col of previewData.columnas">{{ fila[col] }}</td>
        </tr>
      </tbody>
    </table>

    <div class="text-center mt-3">
      <button class="btn btn-success" (click)="confirmarCarga()">Cargar datos</button>
      <button class="btn btn-danger ms-2" (click)="resetearFormulario()">Cancelar</button>
    </div>
  </div>

  <!-- Resultado -->
  <div *ngIf="mostrarResultado" class="mt-4 alert alert-success text-center">
    <h5>âœ… Carga completada</h5>
    <p>Ã‰xitosos: {{ resultadoCarga.exitosos }} | Fallidos: {{ resultadoCarga.fallidos }}</p>
  </div>
</div>
